CREATE EXTENSION IF NOT EXISTS postgis CASCADE;
CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE;
CREATE SCHEMA IF NOT EXISTS "mtekz";
CREATE TABLE IF NOT EXISTS "mtekz"."etairqualityobserved" ("__original_ngsi_entity__" jsonb, "address" jsonb, "airqualityindex" float, "airqualitylevel" text, "co" float, "dataowner" text, "dataprovider" text, "dateobserved" timestamp WITH TIME ZONE, "drewpoint" float, "entity_id" text, "entity_type" text, "fiware_servicepath" text, "location" geometry, "location_centroid" geometry, "name" text, "no" float, "no2" float, "o3" float, "pm1" float, "pm10" float, "pm25" float, "pm2_5" float, "pressure" float, "refdevice" text, "refweatherobserved" text, "relativehumidity" float, "reliability" float, "so2" float, "temperature" float, "time_index" timestamp WITH TIME ZONE NOT NULL, "timeinstant" text, "uid" bigint);
ALTER TABLE "mtekz"."etairqualityobserved" ADD COLUMN IF NOT EXISTS "__original_ngsi_entity__" jsonb, ADD COLUMN IF NOT EXISTS "address" jsonb, ADD COLUMN IF NOT EXISTS "airqualityindex" float, ADD COLUMN IF NOT EXISTS "airqualitylevel" text, ADD COLUMN IF NOT EXISTS "co" float, ADD COLUMN IF NOT EXISTS "dataowner" text, ADD COLUMN IF NOT EXISTS "dataprovider" text, ADD COLUMN IF NOT EXISTS "dateobserved" timestamp WITH TIME ZONE, ADD COLUMN IF NOT EXISTS "drewpoint" float, ADD COLUMN IF NOT EXISTS "entity_id" text, ADD COLUMN IF NOT EXISTS "entity_type" text, ADD COLUMN IF NOT EXISTS "fiware_servicepath" text, ADD COLUMN IF NOT EXISTS "location" geometry, ADD COLUMN IF NOT EXISTS "location_centroid" geometry, ADD COLUMN IF NOT EXISTS "name" text, ADD COLUMN IF NOT EXISTS "no" float, ADD COLUMN IF NOT EXISTS "no2" float, ADD COLUMN IF NOT EXISTS "o3" float, ADD COLUMN IF NOT EXISTS "pm1" float, ADD COLUMN IF NOT EXISTS "pm10" float, ADD COLUMN IF NOT EXISTS "pm25" float, ADD COLUMN IF NOT EXISTS "pm2_5" float, ADD COLUMN IF NOT EXISTS "pressure" float, ADD COLUMN IF NOT EXISTS "refdevice" text, ADD COLUMN IF NOT EXISTS "refweatherobserved" text, ADD COLUMN IF NOT EXISTS "relativehumidity" float, ADD COLUMN IF NOT EXISTS "reliability" float, ADD COLUMN IF NOT EXISTS "so2" float, ADD COLUMN IF NOT EXISTS "temperature" float, ADD COLUMN IF NOT EXISTS "time_index" timestamp WITH TIME ZONE NOT NULL, ADD COLUMN IF NOT EXISTS "timeinstant" text, ADD COLUMN IF NOT EXISTS "uid" bigint;
SELECT create_hypertable('"mtekz"."etairqualityobserved"', 'time_index', if_not_exists => true);
INSERT INTO "mtekz"."etairqualityobserved"
("__original_ngsi_entity__", "address", "airqualityindex", "airqualitylevel", "co", "dataowner", "dataprovider", "dateobserved", "drewpoint", "entity_id", "entity_type", "fiware_servicepath", "location", "location_centroid", "name", "no", "no2", "o3", "pm1", "pm10", "pm25", "pm2_5", "pressure", "refdevice", "refweatherobserved", "relativehumidity", "reliability", "so2", "temperature", "time_index", "timeinstant", "uid")
VALUES
(null, null, 20.0, null, null, null, 'https://www.purpleair.com', '2020-11-20T09:14:52+00:00', null, 'urn:ngsi-ld:AirQualityObserved:EKZ-IslandB', 'AirQualityObserved', '/EnvironmentManagement/PurpleAir', ST_GeomFromGeoJSON('{"coordinates": [8.39913, 47.388558], "type": "Point"}'), 'POINT (8.39913 47.388558)', 'PA:EKZ-Island B', null, null, null, 3.07, 5.64, null, 4.76, null, 'urn:ngsi-ld:Device:PA:32278', null, 0.0, null, null, -17.78, '2020-11-20T09:14:52+00:00', null, null)
, (null, null, 210, null, 214.8453, null, 'NABEL', '2020-11-20T09:10:00+00:00', null, 'urn:ngsi-ld:AirQualityObserved:Duebendorf', 'AirQualityObserved', '/EnvironmentManagement/Nabel', ST_GeomFromGeoJSON('{"coordinates": [8.613334, 47.403057], "type": "Point"}'), 'POINT (8.613334 47.403057)', 'NABEL:Duebendorf', 1.790832, 12.624689, 44.453087, null, 4.660664, null, 3.386199, 981.31604, null, null, 82.22025, null, 0.698804, 6.01475, '2020-11-20T09:10:00+00:00', null, null)
, (null, null, 120, null, null, null, 'https://cloud.aeroqual.com', '2020-11-20T09:10:00+00:00', 4.1, 'urn:ngsi-ld:AirQualityObserved:AQY_BB-629', 'AirQualityObserved', '/EnvironmentManagement/Aeroqual', ST_GeomFromGeoJSON('{"coordinates": [8.441694, 47.3368866], "type": "Point"}'), 'POINT (8.441694 47.3368866)', 'AQ:AQY_BB-629', null, 12.2, 12.5, null, null, null, 1.0, null, 'urn:ngsi-ld:Device:AQ:AQY_BB-629', null, 35.0, null, null, 20.01, '2020-11-20T08:00:00+00:00', null, null)
, (null, '{"addressLocality": "Zurich"}', 310, '-', null, 'OSTLUFT - die Luftqualit&aumlts&uumlberwachung der Ostschweizer Kantone und des F&uumlrstentums Liechtenstein', 'https://api.waqi.info', '2020-11-20T08:00:00+00:00', null, 'urn:ngsi-ld:AirQualityObserved:Dubendorf-5769', 'AirQualityObserved', '/EnvironmentManagement/WAQI', ST_GeomFromGeoJSON('{"coordinates": [8.541694, 47.3768866], "type": "Point"}'), 'POINT (8.541694 47.3768866)', 'WAQI:Zurich', null, 5.1, 16.1, null, 8.0, null, null, null, null, 'https://api.ekz.orchestracities.com/context/v2/entities/urn:ngsi-ld:WeatherObserved:Dubendorf', 96.5, null, 12.6, 4.5, '2020-11-20T08:00:00+00:00', null, null)
, (null, '{"addressLocality": "Dubendorf Empa, Switzerland"}', 10.0, '-', null, 'NABEL / FOEN - Switzerland Federal Office for the Environment', 'https://api.waqi.info', '2020-11-20T08:00:00+00:00', null, 'urn:ngsi-ld:AirQualityObserved:Dubendorf-2702', 'AirQualityObserved', '/EnvironmentManagement/WAQI', ST_GeomFromGeoJSON('{"coordinates": [8.613333333, 47.403055556], "type": "Point"}'), 'POINT (8.613333333 47.403055556)', 'WAQI:Dubendorf Empa, Switzerland', null, 13.4, 9.0, null, 6.0, null, 2.0, null, null, 'https://api.ekz.orchestracities.com/context/v2/entities/urn:ngsi-ld:WeatherObserved:Dubendorf', 93.0, null, 0.4, 5.0, '2020-11-20T08:00:00+00:00', null, null)
, (null, null, 80, null, null, null, 'https://data.hawadawa.com', '2020-11-20T08:00:00+00:00', null, 'urn:ngsi-ld:AirQualityObserved:29', 'AirQualityObserved', '/EnvironmentManagement/HawaDawa', ST_GeomFromGeoJSON('{"coordinates": [8.593413184, 47.402946513], "type": "Point"}'), 'POINT (8.593413184 47.402946513)', 'HD:29', null, 29.0, 24.0, null, 6.0, null, 4.0, null, 'urn:ngsi-ld:Device:HD:29', null, 100.0, null, null, 7.9, '2020-11-20T08:00:00+00:00', null, null)
;
